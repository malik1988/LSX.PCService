# LSX.PCService
流水线上位机服务程序

## 系统逻辑
1. 导入总捡单
1. 导入质检单（item对应的物料是否需要质检）
1. 总捡单中 栈板号对应的item编码不唯一则判定为散料，需要流水线处理，否则不需要整托不需要流水线。
1. 总捡单中数据按照车次分组开始，每次只能开始一个车次的订单。
1. 
1. 流水线行进触发相机拍照识别并获取任务单号（09码、数量）
1. 根据09码不同分配到指定道口


1. 扫描栈板号预分派

1. 一个09码可能对应多个LPN，一个LPN就是一个灯，没有托盘的概念
1. 回传以LPN为单位回传
1. 绑定LPN的时候提示质检信息
1. 质检信息是09码对应表格提供的

1. 箱号唯一
根据箱号合并数量
2. 09码对应LPN，根据09码合并道口
一个09码对应多个箱号，合并分拣到一个道口


## 可能问题
1. 箱上 摆放面可能会出现扫不到
1. 箱子上条码有多个，识别箱号可能会出现问题


## 数据字段

1. 箱号
1. 栈板号
1. 车牌
1. 发货单号
1. 到货地点 松山湖34号的 质检信息必须 导入，其他可用现成的
1. 物料号（item）   09+item+收据号
1. 收据号 
1. 检验标志
1. 数量 （累计总数用）
1. 原产国


## AGV转运
1. 四个目的地 ，目的地=到货地址+质检标志
2. 起始地 ，扫描地上的库位号（跟LPN能区分）


## 按灯
1. 2个分拣口的灯是独立的
1. 1个分拣口只会有一个灯亮
1. 灯必须手动按灭才能点亮下

## 回传
1. LPN维度上传
1. 支持重传
1. 单独线程上传

## 报表数量不符
1. 如果订单没全部完成，上传CWMS提示订单未完成，CWMS提供接口
1. 手动关单界面
	1. 人工扫描订单
	1. 人工、自动扫描同时进行
	1. 手动结束订单



## 数据库模型
- TableOrgRecv 原始导入数据表 09码绑定



## 逻辑模型

- 输入箱号->触发



## 与流水线通道控制消息协议


   |功能码|通道号|说明|
   |--|--|--|
   |0x10|1，2，3|PC向流水线发送目标通道|
   |0x20|1,2,3|流水线向PC发送通道货物到达|
   |0x30|1,2,3|流水线向PC发送通道货物取走|